#main program for analyzing fasta files generated by GlimmerHMM
#author: Noora Camilla Montonen 
#email: s1006608@sms.ed.ac.uk
import geneparser

#INPUT/OUTPUT OPTIONS 
#	-input is a file which contains the name of the training species and the name of the processed GlimmerHMM output file separated by a tab
#	-DO NOT INCLUDE QUOTATIONS IN THE FILENAMES OF SPECIES NAMES

#read the filenames into an array 

glimmer_files=[]
filenames=open('haggis_filenames.txt','r')
for line in filenames:
	glimmer_files.append(line.split())

#make a dictionary with the species name as key and the filename as the value

input_files_dict={}
for element in glimmer_files:
	input_files_dict[element[0]]=element[1]

#for each element in the dictionary, go through the analysis pipeline

for element in input_files_dict.keys():
	exon_positions=geneparser.exon_positions(input_files_dict[element])
	translated_exons=geneparser.translate_exons(exon_positions)
	concatenated_exons=geneparser.concatenate_exons(translated_exons)
	fastaheaders=geneparser.fasta_headers(concatenated_exons,element)
	geneparser.make_fasta_file(concatenated_exos,fastaheaders,'trained_on_'+element+'.fasta')

